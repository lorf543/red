{% extends 'base.html' %}
{% load humanize %}

{% block content %}
<div class="max-w-2xl mx-auto p-4">

  <!-- Comentario padre (si este comentario es respuesta) -->
  {% if parent %}
  <div class="mb-6 p-4 bg-base-200 rounded-lg shadow-sm">
    <div class="flex items-center gap-3 mb-3">
      <div class="avatar">
        <div class="w-10 h-10 rounded-full overflow-hidden">
          {% if parent.user.profile.profile_picture %}
            <img src="{{ parent.user.profile.profile_picture.url }}" alt="{{ parent.user.username }}" class="w-10 h-10 object-cover object-center rounded-full" />
          {% else %}
            <div class="w-10 h-10 bg-indigo-100 border-2 border-indigo-500 flex items-center justify-center text-indigo-700 font-bold">
              {{ parent.user.username|slice:":1"|upper }}
            </div>
          {% endif %}
        </div>
      </div>
      <div>
        <h3 class="font-bold">{{ parent.user.username }}</h3>
        <span class="text-xs text-gray-500">{{ parent.created_at|naturaltime }}</span>
      </div>
    </div>
    <p class="pl-13 whitespace-pre-line">{{ parent.content }}</p>
  </div>
  {% endif %}

  <!-- Comentario principal -->
  {% comment %} <div class="p-4 bg-base-100 rounded-lg shadow-md border-l-4 border-primary mb-8">
    <div class="flex items-center gap-3 mb-3">
      <div class="avatar">
        <div class="w-10 h-10 rounded-full overflow-hidden">
          {% if comment.user.profile.profile_picture %}
            <img src="{{ comment.user.profile.profile_picture.url }}" alt="{{ comment.user.username }}" />
          {% else %}
            <div class="w-10 h-10 bg-indigo-100 border-2 border-indigo-500 flex items-center justify-center text-indigo-700 font-bold">
              {{ comment.user.username|slice:":1"|upper }}
            </div>
          {% endif %}
        </div>
      </div>
      <div>
        <h3 class="font-bold">{{ comment.user.username }}</h3>
        <span class="text-xs text-gray-500">{{ comment.created_at|naturaltime }}</span>
      </div>
    </div>
    <p class="pl-13 whitespace-pre-line mb-4">{{ comment.content }}</p> {% endcomment %}

    <!-- Aquí podemos mostrar replies, por ejemplo -->
    <div id="commentsContainer" class="space-y-6">
      {% for c in comments %}
        {% include "components/comment_item.html" with comments=c %}
      {% empty %}
        <p class="text-text-500">No hay respuestas aún.</p>
      {% endfor %}
    </div>
  </div>

  <!-- Botón de volver -->
  <div class="mt-6">
    <a href="{% url 'home' %}" class="btn btn-neutral">
      Volver
    </a>
  </div>

</div>
{% endblock %}
