<div class="bg-surface rounded-xl shadow-sm border border-theme p-6">

    <form method="post" action="{% url 'style_settings' %}" class="space-y-8">
        {% csrf_token %}

        <!-- FONDO DE PERFIL -->
        <div>
            <h3 class="text-lg font-semibold text-text mb-4 flex items-center">
                <i class="fas fa-image mr-2" style="color: var(--color-primary);"></i>
                Fondo de perfil
            </h3>

            <div class="flex flex-col lg:flex-row gap-6 items-start">
                <div class="w-full lg:w-1/2">
                    <label for="background_url" class="block text-sm font-medium text-text mb-2">
                        URL del fondo
                    </label>
                    <input
                        id="background_url"
                        type="url"
                        name="background_url"
                        class="w-full px-4 py-2.5 border border-theme rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition bg-surface text-text"
                        placeholder="https://images.unsplash.com/photo-example.jpg"
                        value="{{ request.user.profile.background_url|default:'' }}"
                    >
                    <p class="text-muted text-xs mt-2 flex items-start">
                        <i class="fas fa-info-circle mr-1 mt-0.5"></i>
                        <span>Ten en cuenta que esto podr√≠a afectar los tiempos de carga</span>
                    </p>
                </div>

                <div class="w-full lg:w-1/2">
                    <label class="block text-sm font-medium text-text mb-2">
                        Vista previa
                    </label>
                    <div id="background_container"
                        class="relative h-48 rounded-lg overflow-hidden shadow-md transition-all duration-300 border-2 border-dashed border-theme bg-surface flex items-center justify-center">
                        <div class="text-center text-muted">
                            <i class="fas fa-image text-4xl mb-2"></i>
                            <p class="text-sm">Ingresa una URL para ver la vista previa</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
                    <!-- Recursos √∫tiles -->
            <div class="mt-6 bg-warning/10 border border-warning/20 rounded-lg p-4">
                <p class="text-sm text-warning flex items-start">
                    <i class="fas fa-star mr-2 mt-0.5" style="color: var(--color-warning);"></i>
                    <span>
                        <strong>Recursos recomendados:</strong> 
                        <a href="https://www.artstation.com/" target="_blank" class="underline font-medium hover:text-warning" style="color: var(--color-warning);">Cursors-4u.com</a>, 
                    </span>
                </p>
            </div>

        <hr class="border-theme">
        <div>
        <p>desde un PC puedes hacer cosas aun mas cool, como cambiar el puntero de mouse</p>
        </div>
        <!-- CURSORES PERSONALIZADOS -->
        <div class="hidden mg:block lg:block">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-lg font-semibold text-text flex items-center">
                    <i class="fas fa-mouse-pointer mr-2" style="color: var(--color-primary);"></i>
                    Cursores personalizados
                </h3>
                <button type="button" 
                        onclick="resetAllCursors()"
                        class="text-sm px-4 py-2 text-danger hover:text-danger border border-danger/30 rounded-lg hover:bg-danger/10 transition">
                    <i class="fas fa-trash-alt mr-1"></i>
                    Resetear todos
                </button>
            </div>

            <!-- Ayuda -->
            <div class="mb-6 bg-info/10 border border-info/20 rounded-lg p-4">
                <p class="text-sm text-info flex items-start">
                    <i class="fas fa-lightbulb mr-2 mt-0.5" style="color: var(--color-info);"></i>
                    <span>
                        <strong>¬øC√≥mo funciona?</strong> Cada cursor tiene su propia URL y punto de clic (hotspot). 
                        El <strong class="text-danger">punto rojo</strong> indica d√≥nde se registrar√° el clic. 
                        Ajusta las coordenadas X,Y para posicionarlo correctamente.
                    </span>
                </p>
            </div>

            <!-- Grid de Cursores -->
            <div class="space-y-6">

                <!-- Cursor Default -->
                <div class="bg-gradient-to-br from-surface to-surface/80 border-2 border-theme rounded-xl p-5 hover:border-primary/30 transition-all shadow-sm">
                    <div class="flex items-center justify-between mb-4">
                        <h4 class="font-semibold text-text flex items-center text-lg">
                            <span class="text-2xl mr-3">‚¨§</span>
                            Cursor Default
                        </h4>
                        <span class="text-xs bg-muted/10 text-muted px-3 py-1 rounded-full font-mono">default</span>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Inputs -->
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-text mb-2">URL del cursor</label>
                                <input
                                    type="url"
                                    name="cursor_url"
                                    class="cursor-url-input w-full px-3 py-2 border border-theme rounded-lg focus:ring-2 focus:ring-primary focus:border-primary text-sm bg-surface text-text"
                                    placeholder="https://example.com/cursor.png"
                                    value="{{ request.user.profile.cursor_url|default:'' }}"
                                    data-cursor-type="default"
                                    data-x-input="cursor_hotspot_x"
                                    data-y-input="cursor_hotspot_y"
                                >
                            </div>
                            
                            <div class="bg-surface/50 border border-theme rounded-lg p-4">
                                <p class="text-sm font-medium text-text mb-3 flex items-center">
                                    <i class="fas fa-crosshairs mr-2" style="color: var(--color-primary);"></i>
                                    Punto de clic (Hotspot)
                                </p>
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-xs text-muted mb-1">X (horizontal)</label>
                                        <input
                                            id="cursor_hotspot_x"
                                            type="number"
                                            name="cursor_hotspot_x"
                                            min="0"
                                            class="hotspot-input w-full px-3 py-2 border border-theme rounded-md focus:ring-2 focus:ring-primary focus:border-primary text-sm bg-surface text-text"
                                            value="{{ request.user.profile.cursor_hotspot_x|default:0 }}"
                                            data-cursor-type="default"
                                        >
                                    </div>
                                    <div>
                                        <label class="block text-xs text-muted mb-1">Y (vertical)</label>
                                        <input
                                            id="cursor_hotspot_y"
                                            type="number"
                                            name="cursor_hotspot_y"
                                            min="0"
                                            class="hotspot-input w-full px-3 py-2 border border-theme rounded-md focus:ring-2 focus:ring-primary focus:border-primary text-sm bg-surface text-text"
                                            value="{{ request.user.profile.cursor_hotspot_y|default:0 }}"
                                            data-cursor-type="default"
                                        >
                                    </div>
                                </div>
                                <div class="flex gap-2 mt-3 flex-wrap">
                                    <button type="button" 
                                            onclick="setHotspot('default', 0, 0)"
                                            class="text-xs px-3 py-1.5 bg-muted/10 text-text rounded hover:bg-muted/20 border border-theme">
                                        0,0
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Preview Mejorado -->
                        <div class="cursor-preview-container" data-cursor-type="default">
                            <div class="bg-surface border-2 border-primary/20 rounded-lg p-4">
                                <p class="text-sm font-semibold text-text mb-3 flex items-center">
                                    <i class="fas fa-eye mr-2" style="color: var(--color-primary);"></i>
                                    Vista previa del cursor
                                </p>
                                
                                <!-- Canvas de Preview -->
                                <div class="relative bg-surface/50 rounded-lg p-4 border-2 border-dashed border-theme min-h-[200px] flex items-center justify-center cursor-target-area"
                                     data-cursor-type="default">
                                    <div class="cursor-preview-placeholder text-muted text-center">
                                        <i class="fas fa-mouse-pointer text-4xl mb-2"></i>
                                        <p class="text-sm">Ingresa una URL para ver el preview</p>
                                    </div>
                                    
                                    <!-- Imagen del cursor -->
                                    <div class="cursor-preview-image-container hidden">
                                        <div class="relative inline-block">
                                            <img class="cursor-preview-image max-w-[128px] max-h-[128px] border-2 border-muted rounded shadow-lg" alt="Cursor">
                                            <!-- Hotspot marker -->
                                            <div class="cursor-hotspot-marker absolute w-4 h-4 bg-danger rounded-full border-2 border-white shadow-lg"
                                                 style="transform: translate(-50%, -50%);"></div>
                                            <!-- Crosshair -->
                                            <div class="cursor-crosshair-h absolute h-px bg-danger/50 opacity-50" style="width: 200%; left: -50%; top: 50%; transform: translateY(-50%);"></div>
                                            <div class="cursor-crosshair-v absolute w-px bg-danger/50 opacity-50" style="height: 200%; top: -50%; left: 50%; transform: translateX(-50%);"></div>
                                        </div>
                                        <div class="mt-3 text-xs text-muted space-y-1">
                                            <p class="flex items-center justify-between">
                                                <span><i class="fas fa-ruler mr-1"></i>Tama√±o:</span>
                                                <span class="cursor-size font-mono bg-muted/10 text-text px-2 py-0.5 rounded">-</span>
                                            </p>
                                            <p class="flex items-center justify-between">
                                                <span><i class="fas fa-crosshairs mr-1 text-danger"></i>Hotspot:</span>
                                                <span class="cursor-hotspot-coords font-mono bg-muted/10 text-text px-2 py-0.5 rounded">-</span>
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <!-- √Årea de prueba interactiva -->
                                <div class="mt-4 bg-primary/10 border-2 border-primary/20 rounded-lg p-3">
                                    <p class="text-xs font-medium" style="color: var(--color-primary);">√Årea de prueba:</p>
                                    <div class="cursor-test-box bg-surface border-2 border-primary/30 rounded-lg p-6 text-center hover:bg-primary/5 transition cursor-pointer"
                                         data-cursor="default">
                                        <span class="text-2xl">‚¨§</span>
                                        <p class="text-xs text-muted mt-1 cursor-coords font-mono"></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cursor Pointer -->
                <div class="bg-gradient-to-br from-surface to-surface/80 border-2 border-theme rounded-xl p-5 hover:border-primary/30 transition-all shadow-sm">
                    <div class="flex items-center justify-between mb-4">
                        <h4 class="font-semibold text-text flex items-center text-lg">
                            <span class="text-2xl mr-3">üëÜ</span>
                            Cursor Pointer
                        </h4>
                        <span class="text-xs bg-muted/10 text-muted px-3 py-1 rounded-full font-mono">pointer</span>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-text mb-2">URL del cursor</label>
                                <input
                                    type="url"
                                    name="cursor_pointer_url"
                                    class="cursor-url-input w-full px-3 py-2 border border-theme rounded-lg focus:ring-2 focus:ring-primary focus:border-primary text-sm bg-surface text-text"
                                    placeholder="https://example.com/pointer.png"
                                    value="{{ request.user.profile.cursor_pointer_url|default:'' }}"
                                    data-cursor-type="pointer"
                                    data-x-input="cursor_pointer_hotspot_x"
                                    data-y-input="cursor_pointer_hotspot_y"
                                >
                            </div>
                            
                            <div class="bg-surface/50 border border-theme rounded-lg p-4">
                                <p class="text-sm font-medium text-text mb-3 flex items-center">
                                    <i class="fas fa-crosshairs mr-2" style="color: var(--color-primary);"></i>
                                    Punto de clic (Hotspot)
                                </p>
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-xs text-muted mb-1">X</label>
                                        <input
                                            id="cursor_pointer_hotspot_x"
                                            type="number"
                                            name="cursor_pointer_hotspot_x"
                                            min="0"
                                            class="hotspot-input w-full px-3 py-2 border border-theme rounded-md focus:ring-2 focus:ring-primary focus:border-primary text-sm bg-surface text-text"
                                            value="{{ request.user.profile.cursor_pointer_hotspot_x|default:0 }}"
                                            data-cursor-type="pointer"
                                        >
                                    </div>
                                    <div>
                                        <label class="block text-xs text-muted mb-1">Y</label>
                                        <input
                                            id="cursor_pointer_hotspot_y"
                                            type="number"
                                            name="cursor_pointer_hotspot_y"
                                            min="0"
                                            class="hotspot-input w-full px-3 py-2 border border-theme rounded-md focus:ring-2 focus:ring-primary focus:border-primary text-sm bg-surface text-text"
                                            value="{{ request.user.profile.cursor_pointer_hotspot_y|default:0 }}"
                                            data-cursor-type="pointer"
                                        >
                                    </div>
                                </div>
                                <div class="flex gap-2 mt-3 flex-wrap">
                                    <button type="button" 
                                            onclick="setHotspot('pointer', 0, 0)"
                                            class="text-xs px-3 py-1.5 bg-muted/10 text-text rounded hover:bg-muted/20 border border-theme">
                                        0,0
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="cursor-preview-container" data-cursor-type="pointer">
                            <div class="bg-surface border-2 border-primary/20 rounded-lg p-4">
                                <p class="text-sm font-semibold text-text mb-3 flex items-center">
                                    <i class="fas fa-eye mr-2" style="color: var(--color-primary);"></i>
                                    Vista previa del cursor
                                </p>
                                
                                <div class="relative bg-surface/50 rounded-lg p-4 border-2 border-dashed border-theme min-h-[200px] flex items-center justify-center cursor-target-area"
                                     data-cursor-type="pointer">
                                    <div class="cursor-preview-placeholder text-muted text-center">
                                        <i class="fas fa-mouse-pointer text-4xl mb-2"></i>
                                        <p class="text-sm">Ingresa una URL para ver el preview</p>
                                    </div>
                                    
                                    <div class="cursor-preview-image-container hidden">
                                        <div class="relative inline-block">
                                            <img class="cursor-preview-image max-w-[128px] max-h-[128px] border-2 border-muted rounded shadow-lg" alt="Cursor">
                                            <div class="cursor-hotspot-marker absolute w-4 h-4 bg-danger rounded-full border-2 border-white shadow-lg"
                                                 style="transform: translate(-50%, -50%);"></div>
                                            <div class="cursor-crosshair-h absolute h-px bg-danger/50 opacity-50" style="width: 200%; left: -50%; top: 50%; transform: translateY(-50%);"></div>
                                            <div class="cursor-crosshair-v absolute w-px bg-danger/50 opacity-50" style="height: 200%; top: -50%; left: 50%; transform: translateX(-50%);"></div>
                                        </div>
                                        <div class="mt-3 text-xs text-muted space-y-1">
                                            <p class="flex items-center justify-between">
                                                <span><i class="fas fa-ruler mr-1"></i>Tama√±o:</span>
                                                <span class="cursor-size font-mono bg-muted/10 text-text px-2 py-0.5 rounded">-</span>
                                            </p>
                                            <p class="flex items-center justify-between">
                                                <span><i class="fas fa-crosshairs mr-1 text-danger"></i>Hotspot:</span>
                                                <span class="cursor-hotspot-coords font-mono bg-muted/10 text-text px-2 py-0.5 rounded">-</span>
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <div class="mt-4 bg-primary/10 border-2 border-primary/20 rounded-lg p-3">
                                    <p class="text-xs font-medium" style="color: var(--color-primary);">√Årea de prueba:</p>
                                    <div class="cursor-test-box bg-surface border-2 border-primary/30 rounded-lg p-6 text-center hover:bg-primary/5 transition cursor-pointer"
                                         data-cursor="pointer">
                                        <span class="text-2xl">üëÜ</span>
                                        <p class="text-xs text-muted mt-1 cursor-coords font-mono"></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cursor Text -->
                <div class="bg-gradient-to-br from-surface to-surface/80 border-2 border-theme rounded-xl p-5 hover:border-primary/30 transition-all shadow-sm">
                    <div class="flex items-center justify-between mb-4">
                        <h4 class="font-semibold text-text flex items-center text-lg">
                            <span class="text-2xl mr-3">üìù</span>
                            Cursor Text
                        </h4>
                        <span class="text-xs bg-muted/10 text-muted px-3 py-1 rounded-full font-mono">text</span>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-text mb-2">URL del cursor</label>
                                <input
                                    type="url"
                                    name="cursor_text_url"
                                    class="cursor-url-input w-full px-3 py-2 border border-theme rounded-lg focus:ring-2 focus:ring-primary focus:border-primary text-sm bg-surface text-text"
                                    placeholder="https://example.com/text.png"
                                    value="{{ request.user.profile.cursor_text_url|default:'' }}"
                                    data-cursor-type="text"
                                    data-x-input="cursor_text_hotspot_x"
                                    data-y-input="cursor_text_hotspot_y"
                                >
                            </div>
                            
                            <div class="bg-surface/50 border border-theme rounded-lg p-4">
                                <p class="text-sm font-medium text-text mb-3 flex items-center">
                                    <i class="fas fa-crosshairs mr-2" style="color: var(--color-primary);"></i>
                                    Punto de clic (Hotspot)
                                </p>
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-xs text-muted mb-1">X</label>
                                        <input
                                            id="cursor_text_hotspot_x"
                                            type="number"
                                            name="cursor_text_hotspot_x"
                                            min="0"
                                            class="hotspot-input w-full px-3 py-2 border border-theme rounded-md focus:ring-2 focus:ring-primary focus:border-primary text-sm bg-surface text-text"
                                            value="{{ request.user.profile.cursor_text_hotspot_x|default:0 }}"
                                            data-cursor-type="text"
                                        >
                                    </div>
                                    <div>
                                        <label class="block text-xs text-muted mb-1">Y</label>
                                        <input
                                            id="cursor_text_hotspot_y"
                                            type="number"
                                            name="cursor_text_hotspot_y"
                                            min="0"
                                            class="hotspot-input w-full px-3 py-2 border border-theme rounded-md focus:ring-2 focus:ring-primary focus:border-primary text-sm bg-surface text-text"
                                            value="{{ request.user.profile.cursor_text_hotspot_y|default:0 }}"
                                            data-cursor-type="text"
                                        >
                                    </div>
                                </div>
                                <div class="flex gap-2 mt-3 flex-wrap">
                                    <button type="button" 
                                            onclick="setHotspot('text', 0, 0)"
                                            class="text-xs px-3 py-1.5 bg-muted/10 text-text rounded hover:bg-muted/20 border border-theme">
                                        0,0
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="cursor-preview-container" data-cursor-type="text">
                            <div class="bg-surface border-2 border-primary/20 rounded-lg p-4">
                                <p class="text-sm font-semibold text-text mb-3 flex items-center">
                                    <i class="fas fa-eye mr-2" style="color: var(--color-primary);"></i>
                                    Vista previa del cursor
                                </p>
                                
                                <div class="relative bg-surface/50 rounded-lg p-4 border-2 border-dashed border-theme min-h-[200px] flex items-center justify-center cursor-target-area"
                                     data-cursor-type="text">
                                    <div class="cursor-preview-placeholder text-muted text-center">
                                        <i class="fas fa-mouse-pointer text-4xl mb-2"></i>
                                        <p class="text-sm">Ingresa una URL para ver el preview</p>
                                    </div>
                                    
                                    <div class="cursor-preview-image-container hidden">
                                        <div class="relative inline-block">
                                            <img class="cursor-preview-image max-w-[128px] max-h-[128px] border-2 border-muted rounded shadow-lg" alt="Cursor">
                                            <div class="cursor-hotspot-marker absolute w-4 h-4 bg-danger rounded-full border-2 border-white shadow-lg"
                                                 style="transform: translate(-50%, -50%);"></div>
                                            <div class="cursor-crosshair-h absolute h-px bg-danger/50 opacity-50" style="width: 200%; left: -50%; top: 50%; transform: translateY(-50%);"></div>
                                            <div class="cursor-crosshair-v absolute w-px bg-danger/50 opacity-50" style="height: 200%; top: -50%; left: 50%; transform: translateX(-50%);"></div>
                                        </div>
                                        <div class="mt-3 text-xs text-muted space-y-1">
                                            <p class="flex items-center justify-between">
                                                <span><i class="fas fa-ruler mr-1"></i>Tama√±o:</span>
                                                <span class="cursor-size font-mono bg-muted/10 text-text px-2 py-0.5 rounded">-</span>
                                            </p>
                                            <p class="flex items-center justify-between">
                                                <span><i class="fas fa-crosshairs mr-1 text-danger"></i>Hotspot:</span>
                                                <span class="cursor-hotspot-coords font-mono bg-muted/10 text-text px-2 py-0.5 rounded">-</span>
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <div class="mt-4 bg-primary/10 border-2 border-primary/20 rounded-lg p-3">
                                    <p class="text-xs font-medium" style="color: var(--color-primary);">√Årea de prueba:</p>
                                    <div class="cursor-test-box bg-surface border-2 border-primary/30 rounded-lg p-6 text-center hover:bg-primary/5 transition cursor-text"
                                         data-cursor="text">
                                        <span class="text-2xl">üìù</span>
                                        <p class="text-xs text-muted mt-1 cursor-coords font-mono"></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cursor Blocked -->
                <div class="bg-gradient-to-br from-surface to-surface/80 border-2 border-theme rounded-xl p-5 hover:border-primary/30 transition-all shadow-sm">
                    <div class="flex items-center justify-between mb-4">
                        <h4 class="font-semibold text-text flex items-center text-lg">
                            <span class="text-2xl mr-3">üö´</span>
                            Cursor Blocked
                        </h4>
                        <span class="text-xs bg-muted/10 text-muted px-3 py-1 rounded-full font-mono">not-allowed</span>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-text mb-2">URL del cursor</label>
                                <input
                                    type="url"
                                    name="cursor_blocked_url"
                                    class="cursor-url-input w-full px-3 py-2 border border-theme rounded-lg focus:ring-2 focus:ring-primary focus:border-primary text-sm bg-surface text-text"
                                    placeholder="https://example.com/blocked.png"
                                    value="{{ request.user.profile.cursor_blocked_url|default:'' }}"
                                    data-cursor-type="not-allowed"
                                    data-x-input="cursor_blocked_hotspot_x"
                                    data-y-input="cursor_blocked_hotspot_y"
                                >
                            </div>
                            
                            <div class="bg-surface/50 border border-theme rounded-lg p-4">
                                <p class="text-sm font-medium text-text mb-3 flex items-center">
                                    <i class="fas fa-crosshairs mr-2" style="color: var(--color-primary);"></i>
                                    Punto de clic (Hotspot)
                                </p>
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-xs text-muted mb-1">X</label>
                                        <input
                                            id="cursor_blocked_hotspot_x"
                                            type="number"
                                            name="cursor_blocked_hotspot_x"
                                            min="0"
                                            class="hotspot-input w-full px-3 py-2 border border-theme rounded-md focus:ring-2 focus:ring-primary focus:border-primary text-sm bg-surface text-text"
                                            value="{{ request.user.profile.cursor_blocked_hotspot_x|default:0 }}"
                                            data-cursor-type="not-allowed"
                                        >
                                    </div>
                                    <div>
                                        <label class="block text-xs text-muted mb-1">Y</label>
                                        <input
                                            id="cursor_blocked_hotspot_y"
                                            type="number"
                                            name="cursor_blocked_hotspot_y"
                                            min="0"
                                            class="hotspot-input w-full px-3 py-2 border border-theme rounded-md focus:ring-2 focus:ring-primary focus:border-primary text-sm bg-surface text-text"
                                            value="{{ request.user.profile.cursor_blocked_hotspot_y|default:0 }}"
                                            data-cursor-type="not-allowed"
                                        >
                                    </div>
                                </div>
                                <div class="flex gap-2 mt-3 flex-wrap">
                                    <button type="button" 
                                            onclick="setHotspot('not-allowed', 0, 0)"
                                            class="text-xs px-3 py-1.5 bg-muted/10 text-text rounded hover:bg-muted/20 border border-theme">
                                        0,0
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="cursor-preview-container" data-cursor-type="not-allowed">
                            <div class="bg-surface border-2 border-primary/20 rounded-lg p-4">
                                <p class="text-sm font-semibold text-text mb-3 flex items-center">
                                    <i class="fas fa-eye mr-2" style="color: var(--color-primary);"></i>
                                    Vista previa del cursor
                                </p>
                                
                                <div class="relative bg-surface/50 rounded-lg p-4 border-2 border-dashed border-theme min-h-[200px] flex items-center justify-center cursor-target-area"
                                     data-cursor-type="not-allowed">
                                    <div class="cursor-preview-placeholder text-muted text-center">
                                        <i class="fas fa-mouse-pointer text-4xl mb-2"></i>
                                        <p class="text-sm">Ingresa una URL para ver el preview</p>
                                    </div>
                                    
                                    <div class="cursor-preview-image-container hidden">
                                        <div class="relative inline-block">
                                            <img class="cursor-preview-image max-w-[128px] max-h-[128px] border-2 border-muted rounded shadow-lg" alt="Cursor">
                                            <div class="cursor-hotspot-marker absolute w-4 h-4 bg-danger rounded-full border-2 border-white shadow-lg"
                                                 style="transform: translate(-50%, -50%);"></div>
                                            <div class="cursor-crosshair-h absolute h-px bg-danger/50 opacity-50" style="width: 200%; left: -50%; top: 50%; transform: translateY(-50%);"></div>
                                            <div class="cursor-crosshair-v absolute w-px bg-danger/50 opacity-50" style="height: 200%; top: -50%; left: 50%; transform: translateX(-50%);"></div>
                                        </div>
                                        <div class="mt-3 text-xs text-muted space-y-1">
                                            <p class="flex items-center justify-between">
                                                <span><i class="fas fa-ruler mr-1"></i>Tama√±o:</span>
                                                <span class="cursor-size font-mono bg-muted/10 text-text px-2 py-0.5 rounded">-</span>
                                            </p>
                                            <p class="flex items-center justify-between">
                                                <span><i class="fas fa-crosshairs mr-1 text-danger"></i>Hotspot:</span>
                                                <span class="cursor-hotspot-coords font-mono bg-muted/10 text-text px-2 py-0.5 rounded">-</span>
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <div class="mt-4 bg-primary/10 border-2 border-primary/20 rounded-lg p-3">
                                    <p class="text-xs font-medium" style="color: var(--color-primary);">√Årea de prueba:</p>
                                    <div class="cursor-test-box bg-surface border-2 border-primary/30 rounded-lg p-6 text-center hover:bg-primary/5 transition cursor-not-allowed"
                                         data-cursor="not-allowed">
                                        <span class="text-2xl">üö´</span>
                                        <p class="text-xs text-muted mt-1 cursor-coords font-mono"></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Recursos √∫tiles -->
            <div class="mt-6 bg-warning/10 border border-warning/20 rounded-lg p-4">
                <p class="text-sm text-warning flex items-start">
                    <i class="fas fa-star mr-2 mt-0.5" style="color: var(--color-warning);"></i>
                    <span>
                        <strong>Recursos recomendados:</strong> 
                        <a href="https://www.cursors-4u.com/" target="_blank" class="underline font-medium hover:text-warning" style="color: var(--color-warning);">Cursors-4u.com</a>, 
                    </span>
                </p>
            </div>
        </div>

        <!-- Botones de Acci√≥n -->
        <div class="flex items-center justify-between pt-6 border-t-2 border-theme">
            <button type="button"
                    onclick="window.location.reload()"
                    class="px-6 py-3 text-text hover:text-text border-2 border-theme rounded-lg hover:bg-muted/10 transition font-medium">
                <i class="fas fa-times mr-2"></i>
                Cancelar
            </button>
            
            <button type="submit"
                    class="px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary/90 transition font-medium shadow-lg hover:shadow-xl" style="background-color: var(--color-primary);">
                <i class="fas fa-save mr-2"></i>
                Guardar configuraci√≥n
            </button>
        </div>

    </form>

</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {

        /* ---------- BACKGROUND PREVIEW ---------- */
        const bgInput = document.getElementById("background_url");
        const bgContainer = document.getElementById("background_container");

        if (bgInput && bgContainer) {
            function hideBg() {
                bgContainer.innerHTML = `
                    <div class="text-center text-gray-400">
                        <i class="fas fa-image text-4xl mb-2"></i>
                        <p class="text-sm">Ingresa una URL para ver la vista previa</p>
                    </div>
                `;
                bgContainer.style.backgroundImage = "";
            }

            function showBg(url) {
                bgContainer.style.backgroundImage = `url("${url}")`;
                bgContainer.style.backgroundSize = "cover";
                bgContainer.style.backgroundPosition = "center";
                bgContainer.innerHTML = "";
            }

            function updateBg() {
                const url = bgInput.value.trim();
                if (!url) return hideBg();

                const img = new Image();
                img.src = url;
                img.onload = () => showBg(url);
                img.onerror = () => {
                    hideBg();
                    console.log("Error cargando imagen de fondo");
                };
            }

            bgInput.addEventListener("input", updateBg);
            setTimeout(updateBg, 100);
        }

        /* ---------- SISTEMA DE CURSORES MEJORADO ---------- */

        // Mapeo de tipos de cursor
        const cursorTypes = ['default', 'pointer', 'text', 'not-allowed'];
        
        // Configuraci√≥n de cursores
        const cursorConfig = {
            'default': {
                urlInput: null,
                xInput: null,
                yInput: null,
                previewContainer: null,
                testBox: null
            },
            'pointer': {
                urlInput: null,
                xInput: null,
                yInput: null,
                previewContainer: null,
                testBox: null
            },
            'text': {
                urlInput: null,
                xInput: null,
                yInput: null,
                previewContainer: null,
                testBox: null
            },
            'not-allowed': {
                urlInput: null,
                xInput: null,
                yInput: null,
                previewContainer: null,
                testBox: null
            }
        };

        // Inicializar referencias DOM
        function initCursorReferences() {
            document.querySelectorAll('.cursor-url-input').forEach(input => {
                const type = input.dataset.cursorType;
                if (type && cursorConfig[type]) {
                    cursorConfig[type].urlInput = input;
                }
            });

            document.querySelectorAll('.hotspot-input').forEach(input => {
                const type = input.dataset.cursorType;
                if (type && cursorConfig[type]) {
                    if (input.name.includes('_x')) {
                        cursorConfig[type].xInput = input;
                    } else {
                        cursorConfig[type].yInput = input;
                    }
                }
            });

            document.querySelectorAll('.cursor-preview-container').forEach(container => {
                const type = container.dataset.cursorType;
                if (type && cursorConfig[type]) {
                    cursorConfig[type].previewContainer = container;
                }
            });

            document.querySelectorAll('.cursor-test-box').forEach(box => {
                const type = box.dataset.cursor;
                if (type && cursorConfig[type]) {
                    cursorConfig[type].testBox = box;
                }
            });
        }

        // Actualizar preview visual del cursor
        function updateCursorPreview(type) {
            const config = cursorConfig[type];
            if (!config || !config.urlInput || !config.previewContainer) return;

            const url = config.urlInput.value.trim();
            const x = parseInt(config.xInput?.value || 0);
            const y = parseInt(config.yInput?.value || 0);

            const placeholder = config.previewContainer.querySelector('.cursor-preview-placeholder');
            const imageContainer = config.previewContainer.querySelector('.cursor-preview-image-container');
            const previewImg = config.previewContainer.querySelector('.cursor-preview-image');
            const hotspotMarker = config.previewContainer.querySelector('.cursor-hotspot-marker');
            const sizeDisplay = config.previewContainer.querySelector('.cursor-size');
            const coordsDisplay = config.previewContainer.querySelector('.cursor-hotspot-coords');

            if (!url) {
                placeholder?.classList.remove('hidden');
                imageContainer?.classList.add('hidden');
                return;
            }

            const img = new Image();
            img.crossOrigin = "anonymous";
            img.src = url;

            img.onload = () => {
                // Mostrar imagen
                if (previewImg) previewImg.src = url;
                
                // Actualizar info
                if (sizeDisplay) sizeDisplay.textContent = `${img.width}√ó${img.height}px`;
                if (coordsDisplay) coordsDisplay.textContent = `${x}, ${y}`;
                
                // Posicionar hotspot marker
                if (hotspotMarker) {
                    hotspotMarker.style.left = `${x}px`;
                    hotspotMarker.style.top = `${y}px`;
                }

                // Toggle visibility
                placeholder?.classList.add('hidden');
                imageContainer?.classList.remove('hidden');

                // Actualizar cursor en √°rea de prueba
                updateTestBoxCursor(type);
            };

            img.onerror = () => {
                placeholder?.classList.remove('hidden');
                imageContainer?.classList.add('hidden');
            };
        }

        // Actualizar cursor en caja de prueba
        function updateTestBoxCursor(type) {
            const config = cursorConfig[type];
            if (!config || !config.testBox) return;

            const url = config.urlInput?.value.trim();
            const x = parseInt(config.xInput?.value || 0);
            const y = parseInt(config.yInput?.value || 0);

            if (url) {
                config.testBox.style.cursor = `url("${url}") ${x} ${y}, ${type}`;
            } else {
                config.testBox.style.cursor = type;
            }
        }

        // Mostrar coordenadas en tiempo real
        function setupCursorTracking() {
            document.querySelectorAll('.cursor-test-box').forEach(box => {
                const coordsDisplay = box.querySelector('.cursor-coords');
                if (!coordsDisplay) return;

                box.addEventListener('mousemove', (e) => {
                    const rect = box.getBoundingClientRect();
                    const x = Math.round(e.clientX - rect.left);
                    const y = Math.round(e.clientY - rect.top);
                    coordsDisplay.textContent = `X: ${x}, Y: ${y}`;
                });

                box.addEventListener('mouseleave', () => {
                    coordsDisplay.textContent = '';
                });
            });
        }

        // Event listeners para inputs
        function setupEventListeners() {
            // Listeners para URL inputs
            document.querySelectorAll('.cursor-url-input').forEach(input => {
                const type = input.dataset.cursorType;
                input.addEventListener('input', () => updateCursorPreview(type));
            });

            // Listeners para hotspot inputs
            document.querySelectorAll('.hotspot-input').forEach(input => {
                const type = input.dataset.cursorType;
                input.addEventListener('input', () => updateCursorPreview(type));
            });
        }

        // Inicializar todo
        initCursorReferences();
        setupEventListeners();
        setupCursorTracking();

        // Cargar previews iniciales
        setTimeout(() => {
            cursorTypes.forEach(type => updateCursorPreview(type));
        }, 100);

        /* ---------- HELPER FUNCTIONS ---------- */

        // Establecer hotspot para un cursor espec√≠fico
        window.setHotspot = function(type, x, y) {
            const config = cursorConfig[type];
            if (!config) return;

            if (config.xInput) config.xInput.value = x;
            if (config.yInput) config.yInput.value = y;
            
            updateCursorPreview(type);
            showNotification(`Hotspot de ${type} actualizado a (${x}, ${y})`, 'success');
        };

        // Detectar centro autom√°ticamente
        window.detectCursorCenter = function(type) {
            const config = cursorConfig[type];
            if (!config || !config.urlInput) return;

            const url = config.urlInput.value.trim();
            if (!url) {
                showNotification('Primero ingresa una URL de cursor', 'warning');
                return;
            }

            const img = new Image();
            img.crossOrigin = "anonymous";
            img.src = url;
            
            img.onload = () => {
                const centerX = Math.floor(img.width / 2);
                const centerY = Math.floor(img.height / 2);
                window.setHotspot(type, centerX, centerY);
            };
            
            img.onerror = () => {
                showNotification('No se pudo cargar la imagen del cursor', 'error');
            };
        };

        // Resetear todos los cursores
        window.resetAllCursors = function() {
            if (!confirm('¬øEst√°s seguro de que deseas resetear TODOS los cursores? Esta acci√≥n no se puede deshacer.')) {
                return;
            }

            cursorTypes.forEach(type => {
                const config = cursorConfig[type];
                if (!config) return;

                if (config.urlInput) config.urlInput.value = '';
                if (config.xInput) config.xInput.value = '0';
                if (config.yInput) config.yInput.value = '0';

                updateCursorPreview(type);
            });

            showNotification('Todos los cursores han sido reseteados', 'info');
        };

        // Sistema de notificaciones mejorado
        function showNotification(message, type = 'info') {
            const colors = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                warning: 'bg-yellow-500',
                info: 'bg-blue-500'
            };

            const icons = {
                success: 'fa-check-circle',
                error: 'fa-exclamation-circle',
                warning: 'fa-exclamation-triangle',
                info: 'fa-info-circle'
            };

            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 ${colors[type]} text-white px-5 py-3 rounded-lg shadow-2xl z-50 flex items-center gap-3 transform transition-all duration-300`;
            notification.style.opacity = '0';
            notification.style.transform = 'translateY(-20px)';
            
            notification.innerHTML = `
                <i class="fas ${icons[type]} text-lg"></i>
                <span class="font-medium">${message}</span>
            `;
            
            document.body.appendChild(notification);

            // Animaci√≥n de entrada
            requestAnimationFrame(() => {
                notification.style.opacity = '1';
                notification.style.transform = 'translateY(0)';
            });

            // Animaci√≥n de salida y eliminaci√≥n
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateY(-20px)';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Hacer funci√≥n disponible globalmente
        window.showNotification = showNotification;

    });
</script>